package snyk.oss

import com.google.gson.annotations.SerializedName
import io.snyk.plugin.Severity

data class Vulnerability(
    val id: String,
    val license: String? = null,
    val identifiers: Identifiers? = null,
    val title: String,
    val description: String,
    val language: String,
    val packageManager: String,
    val packageName: String,
    private val severity: String,
    val name: String,
    val version: String,
    val exploit: String? = null,

    @SerializedName("CVSSv3")
    val cvssV3: String? = null,
    val cvssScore: String? = null,

    val fixedIn: List<String>? = null,
    val from: List<String>,
    val upgradePath: List<String>
) {
    val obsolete: Boolean = false
    val ignored: Boolean = false

    fun getPackageNameTitle(): String = "$packageName@$version: $title"

    fun getSeverity(): Severity = Severity.getFromName(severity)
}

data class Identifiers (
    @SerializedName("CWE")
    val cwe: List<String>,
    @SerializedName("CVE")
    val cve: List<String>
)
